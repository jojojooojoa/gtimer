<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Goon Timer</title>
<link rel="stylesheet" href="./styles.css">
</head>
<body>

<canvas id="cyberCanvas"></canvas>

<!-- Loading Screen -->
<div id="loadingScreen">
    <div id="loadingText">Goon Timer</div>
    <button id="startButton">START</button>
</div>

<!-- Timer Screen -->
<div id="timerScreen">
    <h1>Group Shared Timer</h1>

    <div class="userTimerContainer">
        <div class="userTimer" id="user1">Ralph: 00:00</div>
        <button class="resetButton" data-user="user1">RESET</button>
    </div>
    <div class="userTimerContainer">
        <div class="userTimer" id="user2">Nick: 00:00</div>
        <button class="resetButton" data-user="user2">RESET</button>
    </div>
    <div class="userTimerContainer">
        <div class="userTimer" id="user3">Jun: 00:00</div>
        <button class="resetButton" data-user="user3">RESET</button>
    </div>
    <div class="userTimerContainer">
        <div class="userTimer" id="user4">Nansen: 00:00</div>
        <button class="resetButton" data-user="user4">RESET</button>
    </div>
    <div class="userTimerContainer">
        <div class="userTimer" id="user5">Dinesh: 00:00</div>
        <button class="resetButton" data-user="user5">RESET</button>
    </div>
    <div class="userTimerContainer">
        <div class="userTimer" id="user6">Dustin: 00:00</div>
        <button class="resetButton" data-user="user6">RESET</button>
    </div>
    <div class="userTimerContainer">
        <div class="userTimer" id="user7">Tean: 00:00</div>
        <button class="resetButton" data-user="user7">RESET</button>
    </div>

</div>

<script>
// Canvas animation
const canvas = document.getElementById("cyberCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let particles = [];
for(let i=0;i<200;i++){
    particles.push({
        x:Math.random()*canvas.width,
        y:Math.random()*canvas.height,
        size:Math.random()*3+1,
        speedY:Math.random()*1+0.5,
        color:`hsl(${Math.random()*360},100%,50%)`
    });
}

function animate(){
    ctx.fillStyle = 'rgba(13,13,13,0.2)';
    ctx.fillRect(0,0,canvas.width,canvas.height);

    particles.forEach(p=>{
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.size,0,Math.PI*2);
        ctx.fillStyle=p.color;
        ctx.shadowBlur=20;
        ctx.shadowColor=p.color;
        ctx.fill();

        p.y += p.speedY;
        if(p.y>canvas.height) p.y=0;
    });

    requestAnimationFrame(animate);
}
animate();

// Start button click
const startButton = document.getElementById("startButton");
const loadingScreen = document.getElementById("loadingScreen");
const timerScreen = document.getElementById("timerScreen");

startButton.addEventListener("click",()=>{
    loadingScreen.style.display="none";
    timerScreen.style.display="flex";
    startGroupTimers();
});

// Users array with timers counting UP
let users = [
    {id:"user1", name:"Ralph", time:0},
    {id:"user2", name:"Nick", time:0},
    {id:"user3", name:"Jun", time:0},
    {id:"user4", name:"Nansen", time:0},
    {id:"user5", name:"Dinesh", time:0},
    {id:"user6", name:"Dustin", time:0},
    {id:"user7", name:"Tean", time:0}
];

// Start counting up
function startGroupTimers(){
    setInterval(()=>{
        users.forEach(u=>{
            u.time++;
            const minutes=Math.floor(u.time/60).toString().padStart(2,'0');
            const seconds=(u.time%60).toString().padStart(2,'0');
            document.getElementById(u.id).textContent=`${u.name}: ${minutes}:${seconds}`;
        });
    },1000);
}

// Request notification permission
if ("Notification" in window) {
    if (Notification.permission !== "granted") {
        Notification.requestPermission();
    }
}

// Reset buttons with GOONED notifications
const resetButtons = document.querySelectorAll(".resetButton");
resetButtons.forEach(btn => {
    btn.addEventListener("click", () => {
        const userId = btn.dataset.user;
        const user = users.find(u => u.id === userId);
        if (user) {
            user.time = 0;

            // Send browser notification
            if (Notification.permission === "granted") {
                new Notification("Goon Timer", {
                    body: `${user.name} has GOONED!`,
                    icon: "https://i.imgur.com/6NfmR5J.png" // optional
                });
            }
        }
    });
});
</script>

</body>
</html>
